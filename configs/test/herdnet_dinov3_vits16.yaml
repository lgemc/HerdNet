wandb_project: 'camera-traps'
wandb_entity: 'luis-manrique-car-camera-traps'
wandb_run: 'camera-traps-dinov3-vits16-test'
seed: 1
device_name: 'cuda'

model:
  name: 'HerdNetDinoV3'
  from_torchvision: False
  load_from: '/path/to/your/trained/model.pth'
  resume_from: null
  load_optim: false
  kwargs:
    model_name: 'dinov3_vits16'
    num_classes: 7
    pretrained_weights: null
    repo_path: './dinov3'
    down_ratio: 2
    head_conv: 64
    img_size: 512
    feature_layers: [2, 4, 8, 10]
  freeze: null

datasets:
  img_size: [512,512]
  anno_type: 'point'
  num_classes: 7
  collate_fn: null

  class_def:
    1: 'topi'
    2: 'buffalo'
    3: 'kob'
    4: 'warthog'
    5: 'waterbuck'
    6: 'elephant'

  test:
    name: 'CSVDataset'
    csv_file: '/path/to/your/test/file.csv'
    root_dir: '/path/to/your/test/images/folder'

    albu_transforms:
      Resize:
        height: 512
        width: 512
        p: 1.0
      Normalize:
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
        p: 1.0

    end_transforms:
      DownSample:
        down_ratio: ${test.model.kwargs.down_ratio}
        anno_type: ${test.datasets.anno_type}

test_settings:
  batch_size: 1
  num_workers: 4
  print_freq: 50
  evaluator:
    name: 'HerdNetEvaluator'
    threshold: 5
    select_mode: 'max'
    validate_on: 'f1_score'
    kwargs:
      print_freq: 10
      lmds_kwargs:
        kernel_size: [3,3]
        adapt_ts: 0.3
  stitcher:
    name: 'HerdNetStitcher'
    kwargs:
      overlap: 0
      down_ratio: ${test.model.kwargs.down_ratio}
      up: False
      reduction: 'mean'